<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Green Kitchen</title>
        <script
            src="https://code.jquery.com/jquery-3.7.1.min.js"
            integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo="
            crossorigin="anonymous"
        ></script>
        <link
            href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css"
            rel="stylesheet"
        />
        <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    </head>
    <body>
        <div style="border: 1px solid black; padding: 100px" class="container">
            <div style="padding: 100px">
                <div class="row">
                    <div class="col-md-8">
                        <input
                            class="prompt"
                            type="text"
                            placeholder="Search countries..."
                        />
                    </div>
                    <div class="col-md-4">
                        <a onclick="btn_handler()" class="btn btn-primary"
                            >Submit</a
                        >
                        <a onclick="getData()" class="btn btn-primary"
                            >Submit</a
                        >
                        <input type="text" id="searchInput" />
                    </div>
                </div>
            </div>
        </div>

        <script>
            $(document).ready(function () {
                $("#searchInput").select2({
                    ajax: {
                        url: "http://127.0.0.1:8000/menu",
                        dataType: "json",
                        delay: 250,
                        processResults: function (data) {
                            return {
                                results: data,
                            };
                        },
                        cache: true,
                    },
                    minimumInputLength: 1, // Minimum characters to trigger the search
                });

                axios
                    .get("http://127.0.0.1:8000/menu")
                    .then(function (response) {
                        var menuData = response.data; // Assuming the JSON response is an array of menu items

                        // Transform the menuData into the desired format for select2
                        var vector = menuData.map(function (item) {
                            return {
                                id: item.id,
                                text: item.name,
                            };
                        });

                        $(".prompt").select2({
                            data: vector,
                            minimumInputLength: 2,
                            width: "100%",
                            multiple: true,
                            placeholder: "Enter First Name",
                            templateResult: formatState,
                        });
                    })
                    .catch(function (error) {
                        console.error("Error fetching data:", error);
                    });

                $("#catbtn").trigger("click");
                function formatState(text) {
                    str = "";
                    str +=
                        "<p style='padding-left: 12px;'>" + text.text + "</p>";
                    var $state = $(str);
                    return $state;
                }

                function btn_handler() {
                    var data = $(".prompt").select2("data");
                    alert(data[0].text);
                }
            });

            // $(document).ready(function () {
            //     // how to transform the json into app format
            //     var json = [
            //         {
            //             name: "Nitin Shah",
            //             email: "Nitin@xy",
            //         },
            //         {
            //             name: "SSS Shah",
            //             email: "SS@xy",
            //         },
            //     ];
            //     var vector = [];
            //     $.each(json, function (index, value) {
            //         var tem = {
            //             id: index,
            //             text: value.name,
            //         };
            //         vector.push(tem);
            //     });

            //     var final_json = {
            //         result: vector,
            //     };
            //     console.log(final_json);
            //     $(".prompt").select2({
            //         data: vector,
            //         minimumInputLength: 2,
            //         width: "100%",
            //         multiple: true,
            //         placeholder: "Enter First Name",
            //         templateResult: formatState,
            //     });

            //     function formatState(text) {
            //         str = "";
            //         str +=
            //             "<p style='padding-left: 12px;'>" + text.text + "</p>";
            //         var $state = $(str);
            //         return $state;
            //     }

            //     function btn_handler() {
            //         var data = $(".prompt").select2("data");
            //         alert(data[0].text);
            //     }
            // });
        </script>
    </body>
</html>
